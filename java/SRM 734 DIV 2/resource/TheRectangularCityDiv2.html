<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>John and Brus have found a nice horizontal plane and they built a rectangular city somewhere on the plane.
The city has n rows and m columns of houses, with n*m &le; 20.
More precisely, John and Brus built a house at each lattice point (x, y) such that 0 &le; x &lt; n and 0 &le; y &lt; m.
<br></br><br></br>

Today is a holiday.
John decided to go to the city and visit all the houses.
However, some of the houses are locked since the owners left the city for the holiday.
You are given a String[] <b>city</b>.
For each x and y, the character <b>city</b>[x][y] represents the house at (x, y): '.' is an open house and '#' is a locked one.
<br></br><br></br>

John's trip has to satisfy the following constraints:
<ul>
<li>He has to visit each open house exactly once.</li>
<li>He cannot visit the locked houses and he cannot leave and re-enter the city during the trip.</li>
<li>His trip has to start somewhere on the border of the city. In other words, the first house he visits must have x = 0 or x = n-1 or y = 0 or y = m-1.</li>
<li>His trip also has to end somewhere on the border of the city.</li>
<li>From any house John may only move to an adjacent house. Two houses are adjacent if they are next to each other in the same row or column. Formally, (x1, y1) and (x2, y2) are adjacent if |x1 - x2| + |y1 - y2| = 1.</li>
</ul>

Brus now wants to compute the number of ways in which John can visit all the open houses in the city.
Compute and return that number.
</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>TheRectangularCityDiv2</td></tr><tr><td>Method:</td><td>find</td></tr><tr><td>Parameters:</td><td>String[]</td></tr><tr><td>Returns:</td><td>long</td></tr><tr><td>Method signature:</td><td>long find(String[] city)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>n will be between 1 and 20, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>m will be between 1 and 20, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>n*m will be between 1 and 20, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>city</b> will contain exactly n elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>city</b> will consist of exactly m characters, each being either '.' or '#'.</td></tr><tr><td align="center" valign="top">-</td><td>At least one character in <b>city</b> will be '.'.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{
&quot;....&quot;, 
&quot;.##.&quot;, 
&quot;....&quot;
}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 20</pre></td></tr><tr><td><table><tr><td colspan="2">All houses on the city border have to be visited.
<br></br>
John can start from any of them and choose the direction: either clockwise or counterclockwise.
<br></br>
Thus the total number of ways to visit all open houses is 10 * 2 = 20;</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{
&quot;....&quot;, 
&quot;.###&quot;, 
&quot;....&quot;
}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2">Now John has to start from one of the rightmost houses and then he has to travel around the city to the other rightmost house.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{
&quot;....&quot;, 
&quot;####&quot;, 
&quot;....&quot;
}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">Here it's impossible to visit all opened houses.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{
&quot;....&quot;, 
&quot;....&quot;, 
&quot;....&quot;
}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 80</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>